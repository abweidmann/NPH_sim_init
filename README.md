# NPH_sim_init

These codes were made to prepare GROMACS' production runs of molecular dynamics simulations in the NPH ensemble, as used in https://doi.org/10.1063/5.0234866.

nph_sim_init.sh is the main bash code. It is written in bash to make it easier to run in high-performance computing environments. It reads an input file, here exemplified with ice_prd.csv, which contains the names of each simulation, equilibration run and production run files, along with the pressure and temperature conditions, timestep of the equilibration runs and the equilibration simulation time to extract the initial production frame.

The bash code will call three python codes, to first determine the optimal frame to be chosen from the equilibration run in the neighbourhood of the time given in the input file. This guarantees that the chosen frame is not part of a temperature oscilation too far away from the desired value.

The second python code will run the GROMACS grompp command without a verlet-buffer-tolerance value defined, which will raise a warning suggesting the optimal value based on the energy of the system and the simulation time. This value will be registered and then updated on the mdp files.

Finally, the third python code generates "reports" with temperature and verlet-buffer-tolerance informations necessary to check the sucess of the code.

The codes take into consideration the folder organization and the HPC environment used in this work, which can be easily adaptable by changing the command strings that are generated by the python codes and called by the bash script.
